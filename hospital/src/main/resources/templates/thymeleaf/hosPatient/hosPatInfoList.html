<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>hosPatInfoList</title>
<style type="text/css">
table, td, th {
  border: 1px solid black;
  border-collapse: collapse;
}

table tr:not(:first-child):not(:last-child):hover {
    background-color: #E2E2E2;
}
</style>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.1.min.js"></script>

<script type="text/javascript">

$(document).ready(function(){
	const currentUrl = window.location.pathname;
	const id = currentUrl.split("/")[1];
	if(id === "nursing"){
		var url1 = "nursingList";
	}else if(id === "wardPS"){
		var url1 = "wardPsList";
	}
	$.ajax({
		type : "get",
		url: url1,
		dataType:"html",
		success:function(result){
			$("#topSetting").html(result);
		},
		error:function(){
			alert("서버오류");
		}
	});
});


function SelLoc() {
	var selectedValue = $("#location option:selected").val();
	location.href = "hosPatList?location="+selectedValue;
}

function Selroom() {
	var par2 = $("#searchWord").val();
	var selectedValue = $("#location option:selected").val();
	var par4 = $("#roomN option:selected").val();
	if(par2 != null && par2 != ""){
		location.href = "hosPatList?searchWord="+par2 +"&location=" + selectedValue +"&roomN="+par4;
	}else {
		location.href = "hosPatList?location=" + selectedValue +"&roomN="+par4;
	} 
}


function selectPatient(hospNum){
	location.href = "patientwardPsList?hospNum="+hospNum;
}

</script>

</head>
<body>
<div id="topSetting"></div>
	<table width=800px align="center">
		<form action="hosPatList" method="get" id="frm">
			<tr>
				<td colspan="6" align="center"><input type="search"
					name="searchWord" size=60 th:value="${searchWord}" id="searchWord" />
					<input type="submit" id="sub" value="검색"></td>
			</tr>

			<tr align="right">
				<td colspan="6"><select name="location" id="location"
					th:value="${location}" onchange="SelLoc()"
					style="width: 20%; text-align: center">
						<option value="all" selected="selected">전체</option>
						<option value="normal" th:selected="${location} == 'normal'">4층
							일반병동</option>
						<option value="critical" th:selected="${location} == 'critical'">5층
							중환자실</option>
				</select> <select name="roomN" id="roomN" th:value="${roomN}"
					onchange="Selroom()" style="width: 20%; text-align: center">
						<option value="all" selected="selected">전체</option>
						<option th:each="room : ${room}" th:value="${room.roomNum}"
							th:selected="${room.roomNum} == ${roomN}">[[${room.roomLocation}]]</option>

				</select></td>

			</tr>

		</form>


	</table>

	<table border="1" width=800px align="center">
		<tr>
			<th>입원실</th>
			<th>병상</th>
			<th>환자이름</th>
			<th>입원번호</th>
			<th>담당의</th>
			<th>담당간호사</th>
		</tr>

		<tr th:each="dto : ${list}"
			th:onclick="selectPatient([[${dto.HospitalizationDTO.hospitalizationNum}]])">
			<td>[[${dto.roomLoc}]]호 </td>
			<td>[[${dto.HospitalizationDTO.bedNum}]]</td>
			<td>[[${dto.patientName}]]</td>
			<td>[[${dto.HospitalizationDTO.hospitalizationNum}]]</td>
			<td>[[${dto.HospitalizationDTO.docNum}]]</td>
			<td>[[${dto.HospitalizationDTO.nurNum}]]</td>
		</tr>

		<tr>
			<th colspan="6" style="text-align: center;"><span
				th:if="${page <= 1}">[이전]</span> <span th:if="${page > 1}"> <a
					th:href="|hosPatList?page=${page - 1}&searchWord=${searchWord}&location=${location}&roomN=${roomN}|">[이전]</a>
			</span> <th:block
					th:each="i : ${#numbers.sequence(startPageNum, endPageNum)}">
				[<a
						th:href="|hosPatList?page=${i}&searchWord=${searchWord}&location=${location}&roomN=${roomN}|">[[${i}]]</a>]
			</th:block> <span th:if="${page < maxPage}"> <a
					th:href="@{hosPatList?(page=${page + 1},searchWord=${searchWord},location=${location},roomN=${roomN})}">[다음]</a>
			</span> <span th:if="${page >= maxPage}"> [다음] </span></th>
		</tr>
	</table>
</body>
</html>